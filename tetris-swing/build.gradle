/*
 * Tetris Swing Module
 * ğŸ® Pure Swing GUI Implementation
 * - Traditional Swing-based Tetris game
 * - Java 21 LTS compatible
 * - Standalone desktop application
 */

plugins {
    // Apply the application plugin to add support for building a CLI application in Java.
    id 'application'
    // 'shadow' í”ŒëŸ¬ê·¸ì¸ì„ ì¶”ê°€í•˜ì—¬ ëª¨ë“  ì˜ì¡´ì„±ì„ í¬í•¨í•˜ëŠ” JAR íŒŒì¼ì„ ë§Œë“­ë‹ˆë‹¤.
    id 'com.github.johnrengelman.shadow' version '8.1.1'
}

description = "Tetris Swing Desktop Application"

repositories {
    // Use Maven Central for resolving dependencies.
    mavenCentral()
}

dependencies {
    // ğŸ¯ Core ëª¨ë“ˆ ì˜ì¡´ì„±
    implementation project(':tetris-core')
    
    // Use JUnit Jupiter for testing.
    testImplementation 'org.junit.jupiter:junit-jupiter:5.10.5'
    testRuntimeOnly 'org.junit.platform:junit-platform-launcher'

    // ğŸ“Š ìœ í‹¸ë¦¬í‹° ë¼ì´ë¸ŒëŸ¬ë¦¬
    implementation 'com.google.guava:guava:33.3.1-jre'
    implementation 'org.apache.commons:commons-lang3:3.17.0'
}

// Apply Java 21 LTS toolchain to ease working on different environments.
java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(21)
    }
}

application {
    // Define the main class for the application.
    mainClass = 'seoultech.se.tetris.main.Tetris'
}

// ğŸ“¦ JAR ì„¤ì • ìˆ˜ì •
jar {
    archiveBaseName = 'tetris-swing'
    manifest {
        attributes 'Main-Class': 'seoultech.se.tetris.main.Tetris'
        attributes 'Implementation-Title': 'Tetris Swing Game'
        attributes 'Implementation-Version': project.version
    }
}

// ğŸš€ Shadow JAR ì„¤ì • (ëª¨ë“  ì˜ì¡´ì„± í¬í•¨)
shadowJar {
    archiveBaseName = 'tetris-swing-fat'
    archiveClassifier = '' // ê¸°ë³¸ classifier ì œê±°
    manifest {
        attributes 'Main-Class': 'seoultech.se.tetris.main.Tetris'
    }
}

tasks.named('test') {
    // Use JUnit Platform for unit tests.
    useJUnitPlatform()
    
    testLogging {
        events 'passed', 'skipped', 'failed'
    }
}

// ğŸ¯ ê°œë°œ ì‹¤í–‰ íƒœìŠ¤í¬
tasks.register('dev') {
    group = 'application'
    description = 'Run the Swing application in development mode'
    dependsOn 'run'
}

// ğŸ® ë°°í¬ìš© íƒœìŠ¤í¬
tasks.register('dist') {
    group = 'distribution' 
    description = 'Create distribution package for Swing desktop application'
    dependsOn 'shadowJar'
    
    doLast {
        println 'ğŸ® Tetris Swing Application JAR created:'
        println "   Location: ${tasks.shadowJar.get().archiveFile.get().asFile}"
        println "   Run with: java -jar ${tasks.shadowJar.get().archiveFile.get().asFile.name}"
    }
}
